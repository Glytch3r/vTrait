

--[[██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
   ░▒▓█████▓▒░     ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓███████▓▒░   ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓███████▓▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
  ░▒▓█▓▒░          ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
  ░▒▓█▓▒▒▓███▓▒░   ░▒▓█▓▒░         ░▒▓██████▓▒░      ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█████████▓▒░     ░▒▓███▓▒░     ░▒▓███████▓▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒▓▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒█▒░
   ░▒▓██████▓▒░    ░▒▓████████▓▒░    ░▒▓█▓▒░         ░▒▓█▓▒░      ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓█▓▒░  ░▒█▒░
|‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾|
|                        				 Custom  PZ  Mod  Developer  for  Hire													  |
|‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾|
|                       	Portfolio:  https://steamcommunity.com/id/glytch3r/myworkshopfiles/							          |
|                       		                                    														 	  |
|                       	Discord:    Glytch3r#1337 / glytch3r															      |
|                       		                                    														 	  |
|                       	Support:    https://ko-fi.com/glytch3r														    	  |
|_______________________________________________________________________________________________________________________________-]]
--[[_____________________________________________________________________________________________________________________________
   ░▒▓██████▓▒░    ░▒▓████████▓▒░    ░▒▓█▓▒░         ░▒▓█▓▒░      ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓█▓▒░  ░▒█▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒█▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒▓▒░
  ░▒▓█▓▒▒▓███▓▒░   ░▒▓█▓▒░         ░▒▓██████▓▒░      ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█████████▓▒░     ░▒▓███▓▒░     ░▒▓███████▓▒░
  ░▒▓█▓▒░          ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
   ░▒▓█████▓▒░     ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓███████▓▒░   ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓███████▓▒░
█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████--]]
vTrait = vTrait or {}
--[[ 
vTrait.SkinList_F = {
    ["F_ZedBody01_level1"] = "FemaleBody01",
    ["F_ZedBody01_level2"] = "FemaleBody02",
    ["F_ZedBody01_level3"] = "FemaleBody03",
    ["F_ZedBody01"] = "FemaleBody04",
    ["F_ZedBody02_level1"] = "FemaleBody05",
    ["F_ZedBody02_level2"] = "FemaleBody01",
    ["F_ZedBody02_level3"] = "FemaleBody02",
    ["F_ZedBody02"] = "FemaleBody03",
    ["F_ZedBody03_level1"] = "FemaleBody04",
    ["F_ZedBody03_level2"] = "FemaleBody05",
    ["F_ZedBody03_level3"] = "FemaleBody01",
    ["F_ZedBody03"] = "FemaleBody02",
    ["F_ZedBody04_level1"] = "FemaleBody03",
    ["F_ZedBody04_level2"] = "FemaleBody04",
    ["F_ZedBody04_level3"] = "FemaleBody05",
    ["F_ZedBody04"] = "FemaleBody01",
}

vTrait.SkinList_M = {
    ["M_ZedBody01_level1"] = "MaleBody01",
    ["M_ZedBody01_level2"]= "MaleBody01a",
    ["M_ZedBody01_level3"] = "MaleBody02",
    ["M_ZedBody01"] = "MaleBody02a",
    ["M_ZedBody02_level1"] = "MaleBody03",
    ["M_ZedBody02_level2"]= "MaleBody03a",
    ["M_ZedBody02_level3"] = "MaleBody04",
    ["M_ZedBody02"]= "MaleBody04a",
    ["M_ZedBody03_level1"] = "MaleBody05",
    ["M_ZedBody03_level2"]= "MaleBody05a",
    ["M_ZedBody03_level3"] = "MaleBody01",
    ["M_ZedBody03"] = "MaleBody01a",
    ["M_ZedBody04_level1"] = "MaleBody02",
    ["M_ZedBody04_level2"] = "MaleBody02a",
    ["M_ZedBody04_level3"] = "MaleBody03",
    ["M_ZedBody04"] = "MaleBody03a",
}

function vTrait.isZSkin(skin)
    return skin and skin:match("Zed") ~= nil
end

function vTrait.Humanize(zed)
    local vis = zed:getHumanVisual()
    if vis then
        local skin = vis:getSkinTexture()
        if not vTrait.isZSkin(skin) then
            return
        end

        local skinTab = zed:isFemale() and vTrait.SkinList_F or vTrait.SkinList_M
        local newSkin = skinTab[skin]
        if newSkin == nil then
            newSkin = zed:isFemale() and "FemaleBody01" or "MaleBody01"
        end
        if newSkin then
            local emitter = zed:getEmitter()
            if emitter then
                emitter:stopAll()
            end
            vis:setSkinTextureName(newSkin)
            vTrait.cleanUp(zed)
            zed:resetModelNextFrame()
            zed:resetModel()
        end
    end
end

function vTrait.cleanUp(zed)
    if zed and instanceof(zed, "IsoZombie") then
        local vis = zed:getHumanVisual()
        local iVis = zed:getItemVisuals()
        local bVis = vis:getBodyVisuals()
        local attachedItems = zed:getAttachedItems()
        zed:clearAttachedItems()
        vis:randomDirt()
        vis:removeBlood()

        for i=1, BloodBodyPartType.MAX:index() do
            local part = BloodBodyPartType.FromIndex(i-1)
            vis:setBlood(part, 0)
            vis:setDirt(part, 0)
        end

        for i = 0, iVis:size() - 1 do
            local item = iVis:get(i)
            if item then
                for j = 0, BloodBodyPartType.MAX:index() - 1 do
                    local part = BloodBodyPartType.FromIndex(j)
                    if item:getHole(part) ~= 0 then
                        item:removeHole(j)
                    end
                    item:setBlood(part, 0)
                    item:setDirt(part, 0)
                end
                if item:getInventoryItem() then
                    item:setInventoryItem(nil)
                end
            end
        end

        for j = bVis:size() - 1, 0, -1 do
            local item = bVis:get(j)
            if item then
                local fType = item:getItemType()
                if luautils.stringStarts(fType, "Base.ZedDmg_") or luautils.stringStarts(fType, "Base.Wound_") or luautils.stringStarts(fType, "Base.Bandage_") then
                    vis:removeBodyVisualFromItemType(fType)
                end
            end
        end
        zed:resetModelNextFrame()
        zed:resetModel()
    end
end

function vTrait.getSkin(zed)
    return zed:getHumanVisual():getSkinTexture()
end

 ]]
